/**
 * Effects & Animations - Optimized CRT effects and animations
 * Uses GPU-accelerated properties (transform, opacity)
 */

/* Scanlines Effect - GPU Optimized */
.scanlines {
	position: absolute;
	inset: 0;
	width: 100%;
	height: 100%;
	background: repeating-linear-gradient(
		0deg,
		rgba(139, 115, 85, 0.08) 0px,
		rgba(139, 115, 85, 0.08) 1px,
		transparent 1px,
		transparent 2px
	);
	pointer-events: none;
	z-index: var(--z-overlay);
	animation: scanline-move 8s linear infinite;
	mix-blend-mode: overlay;
	border-radius: inherit;
	overflow: hidden;
	max-width: 100%;
	max-height: 100%;
	contain: layout style paint;
	will-change: transform;
	transform: translateZ(0);
}

@keyframes scanline-move {
	0% { transform: translateY(0); }
	100% { transform: translateY(4px); }
}

/* CRT Scanlines - Always Visible - GPU Optimized */
.crt-scanlines {
	position: absolute;
	inset: 0;
	background: repeating-linear-gradient(
		0deg,
		rgba(139, 115, 85, 0.1) 0px,
		rgba(139, 115, 85, 0.1) 1px,
		transparent 1px,
		transparent 2px
	);
	pointer-events: none;
	z-index: var(--z-crt-effects);
	opacity: 0.8;
	animation: scanline-move 8s linear infinite;
	mix-blend-mode: overlay;
	will-change: transform;
	transform: translateZ(0);
}

/* Static Effect - Optimized */
.static-effect-tv {
	position: absolute;
	inset: 0;
	z-index: var(--z-screen-overlay);
	pointer-events: none;
	animation: static-intense 0.2s steps(8) infinite;
	border-radius: inherit;
	overflow: hidden;
	width: 100%;
	height: 100%;
	max-width: 100%;
	max-height: 100%;
	contain: layout style paint;
	will-change: transform, opacity;
	z-index: var(--z-screen-overlay);
}

.static-noise-overlay {
	width: 100%;
	height: 100%;
	background: 
		radial-gradient(circle at 20% 50%, transparent 0%, rgba(255, 255, 255, 0.1) 50%, transparent 100%),
		radial-gradient(circle at 80% 80%, transparent 0%, rgba(255, 255, 255, 0.1) 50%, transparent 100%),
		repeating-linear-gradient(
			0deg,
			rgba(255, 255, 255, 0.03) 0px,
			rgba(0, 0, 0, 0.03) 1px,
			transparent 1px,
			transparent 2px
		);
	animation: static-noise 0.1s steps(5) infinite;
	will-change: transform;
}

@keyframes static-intense {
	0% { opacity: 1; transform: translate(0, 0); }
	25% { opacity: 0.9; transform: translate(-1px, 1px); }
	50% { opacity: 1; transform: translate(1px, -1px); }
	75% { opacity: 0.9; transform: translate(-1px, -1px); }
	100% { opacity: 1; transform: translate(1px, 1px); }
}

@keyframes static-noise {
	0% { transform: translate(0, 0); }
	25% { transform: translate(-2px, 2px); }
	50% { transform: translate(2px, -2px); }
	75% { transform: translate(-2px, -2px); }
	100% { transform: translate(2px, 2px); }
}

/* TV Screen Glow */
.tv-screen-glow {
	position: absolute;
	inset: 0;
	width: 100%;
	height: 100%;
	background: radial-gradient(ellipse at center, transparent 0%, rgba(139, 115, 85, 0.08) 100%);
	pointer-events: none;
	z-index: var(--z-content-overlay);
	border-radius: inherit;
	overflow: hidden;
	max-width: 100%;
	max-height: 100%;
	contain: layout style paint;
}

/* TV Off Screen */
.tv-off-screen {
	width: 100% !important;
	height: 100% !important;
	position: absolute !important;
	top: 0 !important;
	left: 0 !important;
	right: 0 !important;
	bottom: 0 !important;
	background: 
		radial-gradient(ellipse at center, #222 0%, #000 70%),
		repeating-linear-gradient(
			0deg,
			rgba(0, 0, 0, 0.15) 0px,
			rgba(0, 0, 0, 0.15) 1px,
			transparent 1px,
			transparent 2px
		);
	display: flex !important;
	align-items: center !important;
	justify-content: center !important;
	/* Convex effect for off screen too - matches .tv-screen > * */
	transform: perspective(800px) rotateX(-1.5deg) scale(0.99) !important;
	transform-origin: center center;
	border-radius: clamp(4px, 0.6vw, 8px) !important;
	overflow: hidden !important;
	max-width: 100% !important;
	max-height: 100% !important;
	z-index: 1 !important;
}

.tv-off-message {
	font-size: var(--font-size-base);
	color: #b8956a;
	text-shadow: 
		0 0 8px rgba(184, 149, 106, 0.6),
		0 0 15px rgba(184, 149, 106, 0.4),
		0 0 25px rgba(184, 149, 106, 0.2);
	opacity: 0.9;
	z-index: var(--z-overlay);
}

/* Player Wrapper - GPU Optimized */
.player-wrapper {
	width: 100%;
	height: 100%;
	position: relative;
	transform: perspective(800px) rotateX(-1.5deg);
	transform-origin: center center;
	max-width: 100%;
	max-height: 100%;
	overflow: hidden !important;
	contain: layout style paint;
	clip-path: inset(1px);
	mask-image: radial-gradient(ellipse 96% 96% at 50% 50%, black 93%, transparent 97%);
	-webkit-mask-image: radial-gradient(ellipse 96% 96% at 50% 50%, black 93%, transparent 97%);
	isolation: isolate;
	transform-style: flat;
	margin: 0;
	padding: 0;
	will-change: transform;
	transform: translateZ(0);
}

/* CRT Flicker - Optimized */
.crt-flicker {
	position: absolute;
	inset: -50px;
	background: radial-gradient(circle at 50% 50%, rgba(74, 158, 255, 0.1) 0%, transparent 50%);
	animation: crt-flicker-animation 0.15s infinite;
	pointer-events: none;
	will-change: opacity;
}

@keyframes crt-flicker-animation {
	0%, 100% { opacity: 1; }
	50% { opacity: 0.8; }
}

/* Tap to Start Overlay */
.tap-to-start-overlay {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background: radial-gradient(ellipse at center, #1a1a2e 0%, #000 70%);
	display: flex;
	align-items: center;
	justify-content: center;
	z-index: var(--z-tap-overlay);
	cursor: pointer;
	animation: tv-on-boot 2s ease-in-out infinite;
}

@keyframes tv-on-boot {
	0%, 100% { box-shadow: inset 0 0 80px rgba(74, 158, 255, 0.2); }
	50% { box-shadow: inset 0 0 120px rgba(74, 158, 255, 0.4); }
}

.tap-message {
	color: var(--color-primary);
	text-shadow: 
		0 0 10px var(--color-primary),
		0 0 20px var(--color-primary),
		0 0 40px rgba(74, 158, 255, 0.8);
	animation: pulse-glow 2s ease-in-out infinite;
}

.tap-message .tv-icon {
	font-size: 80px;
	margin-bottom: 20px;
	animation: float-icon 3s ease-in-out infinite;
	filter: drop-shadow(0 0 20px rgba(74, 158, 255, 0.8));
	will-change: transform;
}

@keyframes float-icon {
	0%, 100% { transform: translateY(0); }
	50% { transform: translateY(-10px); }
}

@keyframes pulse-glow {
	0%, 100% { opacity: 0.9; }
	50% { opacity: 1; }
}

.tap-message h2 {
	font-size: 32px;
	font-weight: 700;
	margin: 10px 0;
	letter-spacing: 4px;
	font-family: var(--font-mono);
}

.tap-message p {
	font-size: 16px;
	opacity: 0.8;
	margin: 10px 0;
}

.tap-hint {
	font-size: 14px;
	margin-top: 20px;
	opacity: 0.6;
}

/* Respect user motion preferences */
@media (prefers-reduced-motion: reduce) {
	.scanlines,
	.crt-scanlines,
	.static-effect-tv,
	.static-noise-overlay,
	.player-wrapper,
	.crt-flicker,
	.tap-to-start-overlay,
	.tap-message,
	.tap-message .tv-icon {
		animation: none !important;
		transform: none !important;
	}
	
	.player-wrapper {
		will-change: auto;
	}
}
